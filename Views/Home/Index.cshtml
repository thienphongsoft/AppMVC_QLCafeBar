@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="overlay-wrapper">
    <div class="overlay"><i class="fas fa-3x fa-sync-alt fa-spin"></i><div class="text-bold pt-2">Chờ trong giây lát</div></div>
</div>
<section class="content">
    <div class="container-fluid">
        <!-- Small boxes (Stat box) -->
        <div class="row">
            <div class="col-lg-8">
                <div class="row">
                    <div class="col-lg-6">
                        <!--Don hang moi -->
                        <div class="small-box bg-info">
                            <div class="inner">
                                <h3>@ViewBag.TotalOrders<span style="font-size: 14px"> Phiếu bán mới</span></h3>
                                <h3>@ViewBag.TotalMoney<span style="font-size: 20px"> VND</span></h3>
                                <p>Tổng doanh thu hôm nay</p>
                            </div>
                            <div class="icon">
                                <i class="ion ion-bag"></i>
                            </div>
                            <a href="/BaoCaoDoanhThu/Index" class="small-box-footer">Xem báo cáo <i class="fas fa-arrow-circle-right"></i></a>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <!-- Phieu thu moi -->
                        <div class="small-box bg-success">
                            <div class="inner">
                                <h3>@ViewBag.TotalPhieuThu<span style="font-size: 14px"> Phiếu thu</span></h3>
                                <h3>@ViewBag.TotalTienThu<span style="font-size: 20px"> VND</span></h3>
                                <p>Tổng tiền thu hôm nay</p>
                            </div>
                            <div class="icon">
                                <i class="ion ion-stats-bars"></i>
                            </div>
                            <a href="/BaoCaoDoanhThu/Index" class="small-box-footer">Xem báo cáo <i class="fas fa-arrow-circle-right"></i></a>
                        </div>
                    </div>

                </div>
                <div class="row">
                    <!--Ban dang co khach -->
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-header border-0">
                                <h3 class="card-title">Bàn đang có khách</h3>
                                <div class="card-tools">

                                </div>
                            </div>
                            <div class="card-body table-responsive p-0">
                                <table class="table table-striped table-valign-middle" id="TableCoKhach">
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th>Tên bàn</th>
                                            <th>Giờ vào</th>
                                            <th>Tổng tiền</th>
                                        </tr>
                                    </thead>

                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <!-- doanh thu 7 ngay qua -->
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-header border-0">
                                <div class="d-flex justify-content-between">
                                    <h3 class="card-title"><i class="fas fa-chart-line"></i> Doanh số 7 ngày gần đây</h3>
                                    <a href="/BaoCaoDoanhThu/Index">Xem báo cáo</a>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="d-flex">
                                    <p class="d-flex flex-column">
                                        <span class="text-bold text-lg" id="TongDoanhSo"></span>
                                        <span>Tổng doanh số 7 ngày qua</span>
                                    </p>
                                </div>
                                <!-- /.d-flex -->
                                <div class="position-relative mb-4">
                                    <canvas id="myChart" height="200"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <!--Top 10 san pham theo doanh thu -->
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <i class="fas fa-chart-bar"></i>
                                    Top 10 sản phẩm bán chạy
                                </h3>
                                <div class="card-tools">
                                    <ul class="nav nav-pills ml-auto">
                                        <li class="nav-item">
                                            <a class="nav-link active" href="#doanhthu" data-toggle="tab">Theo doanh thu</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" href="#soluong" data-toggle="tab">Theo số lượng</a>
                                        </li>
                                    </ul>
                                </div>
                            </div><!-- /.card-header -->
                            <div class="card-body">
                                <div class="tab-content p-0">
                                    <div class="chart tab-pane active" id="doanhthu">
                                        <div class="position-relative mb-4">
                                            <canvas id="Top10DoanhThu" height="200"></canvas>
                                        </div>
                                    </div>
                                    <div class="chart tab-pane" id="soluong">
                                        <div class="position-relative mb-4">
                                            <canvas id="Top10SoLuong" height="200"></canvas>
                                        </div>
                                    </div>
                                </div>
                                <div class="d-flex flex-row justify-content-end">
                                    <span class="mr-2">
                                        <i class="fas fa-square text-primary"></i>
                                        <a href="/BaoCaoDoanhThu/Index">Xem báo cáo</a>
                                    </span>
                                </div>
                            </div><!-- /.card-body -->

                        </div>
                    </div>
                </div>

            </div>
            <!-- ./col -->
            <div class="col-lg-4">
                <div class="card">
                    <div class="card-header border-0">
                        <h3 class="card-title">CÁC HOẠT ĐỘNG GẦN ĐÂY</h3>
                        <div class="card-tools">
                            <a href="#" class="btn btn-tool btn-sm">
                                @*<i class="fas fa-download"></i>*@
                            </a>
                            <a href="/NhatKyND/Index" class="btn btn-tool btn-sm">
                                <i class="fas fa-history nav-icon"></i>
                            </a>
                        </div>

                        <div class="form-group">
                            <div class="input-group">
                                <p style="display:none;">Từ ngày: <b id="TuNgay"></b> </p>
                                <p style="display:none;">Đến ngày: <b id="DenNgay"></b></p>
                            </div>
                        </div>

                    </div>
                    <div class="card-body table-responsive p-0">
                        <table class="table table-striped table-valign-middle" id="TableNhatKy">
                            <thead>
                                <tr>
                                    <th>id</th>
                                    <th>Noi dung</th>
                                </tr>
                            </thead>

                        </table>
                    </div>
                </div>
            </div>

            <!-- ./col -->
        </div>
        <!-- /.row -->
        <!-- Main row -->
        <div class="row">


        </div>

        <!-- /.row (main row) -->
    </div><!-- /.container-fluid -->
</section>
<!-- /.content -->
@section scripts{
    <style type="text/css">
        td.details-control {
            background: url('/AdminLTE310/dist/img/details_open.png') no-repeat center center;
            cursor: pointer;
        }

        tr.details td.details-control {
            background: url('/AdminLTE310/dist/img/details_close.png') no-repeat center center;
        }
    </style>
    <script type="text/javascript">
        $(document).ready(function () {
            $('.overlay').hide();
            //load ngay thang
            $(function thoigianthuc () {

                var start = moment().subtract(6, 'days');
                var end = moment();
                function cb(start, end) {
                    $('#TuNgay').text(start.format('YYYY-MM-DD hh:mm A'));
                    $('#DenNgay').text(end.format('YYYY-MM-DD hh:mm A'));
                }
                cb(start, end);
                setTimeout(thoigianthuc, 15000);
            });
            DoanhSo7ngayQua();
            function DoanhSo7ngayQua() {
                $.ajax({
                    url: "/Home/GetDateTimeDoanhSo7Ngay",
                    type: "GET",
                    dataType: "JSON",
                    success: function (data) {
                        var ngay01 = data.Date01;
                        var ngay02 = data.Date02;
                        var ngay03 = data.Date03;
                        var ngay04 = data.Date04;
                        var ngay05 = data.Date05;
                        var ngay06 = data.Date06;
                        var ngay07 = data.Date07;

                        $('#TongDoanhSo').text(CurrencyFormatted(data.TongDoanhSo) + " VND");
                        var Ngay01Value = data.DoanhThu01;
                        var Ngay02Value = data.DoanhThu02;
                        var Ngay03Value = data.DoanhThu03;
                        var Ngay04Value = data.DoanhThu04;
                        var Ngay05Value = data.DoanhThu05;
                        var Ngay06Value = data.DoanhThu06;
                        var Ngay07Value = data.DoanhThu07;
                        $.ajax({
                            type: "POST",
                            url: '@Url.Action("NewChart", "Home")',
                            data: JSON.stringify({

                                Ngay01Value: Ngay01Value,
                                Ngay02Value: Ngay02Value,
                                Ngay03Value: Ngay03Value,
                                Ngay04Value: Ngay04Value,
                                Ngay05Value: Ngay05Value,
                                Ngay06Value: Ngay06Value,
                                Ngay07Value: Ngay07Value
                            }),
                            contentType: "application/json",
                            dataType: "json",
                            success: function (chData) {
                                var aData = chData;
                                var aLabels = aData[0];
                                var aDatasets1 = aData[1];

                                //For Bar Chart
                                var ctx = document.getElementById("myChart").getContext('2d');
                                ctx.height = 230;
                                var myChart = new Chart(ctx, {
                                    type: 'bar',
                                    height: "230px",
                                    width: "300px",
                                    autoSkip: true,
                                    responsive: false,
                                    animation: false,
                                    showDatapoints: true,
                                    legend: { position: 'bottom' },
                                    data: {
                                        //labels: ["M", "T", "W", "T", "F", "S", "S"],
                                        labels: [ngay01, ngay02, ngay03, ngay04, ngay05, ngay06, ngay07],
                                        datasets: [{
                                            label: 'Chỉ tiêu từng ngày',
                                            data: [Ngay01Value, Ngay02Value, Ngay03Value, Ngay04Value, Ngay05Value, Ngay06Value, Ngay07Value],
                                            backgroundColor: ["red", "blue", "green", "yellow", "pink", "brown", "orange"]
                                        }]
                                    },
                                    options: {
                                        tooltips: {
                                            callbacks: {
                                                label: function (t, d) {
                                                    var xLabel = d.datasets[t.datasetIndex].label;
                                                    var yLabel = t.yLabel >= 1000 ? t.yLabel.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") : '$' + t.yLabel;
                                                    return xLabel + ': ' + yLabel;
                                                }
                                            }

                                        },
                                        events: ['click'],
                                        scaleShowValues: true,
                                        scales: {
                                            yAxes: [{
                                                ticks: {
                                                    beginAtZero: true,
                                                    callback: function (value, index, values) {
                                                        if (parseInt(value) <= 1000) {
                                                            value /= 1000
                                                            return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "k";
                                                        } else {
                                                            value /= 1000000
                                                            return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "tr";
                                                        }
                                                    }
                                                }

                                            }],
                                            xAxes: [{
                                                ticks: {
                                                    autoSkip: false

                                                }
                                            }]
                                        }
                                    }
                                });

                            },
                            "error": function (data) {
                                alert("Chưa đủ số liệu!");
                            }
                        });
                    },
                    "error": function (data) {
                        alert("Chưa đủ số liệu trong controller!");
                    }

                });
                //tu dong refresh 5000 la 5 giay
                //setTimeout(GenerateRuntimeGraph, 5000);
            }
            //load nhat ky cac hoat dong nguoi dung
            $(function CacHoatDong() {
                var ngaystart = $('#TuNgay').text();
                var ngayend = $('#DenNgay').text();
                $('#TableNhatKy').DataTable().clear().destroy();
                $("#TableNhatKy").DataTable({

                    "paging": false,
                    "lengthChange": false,
                    "searching": false,
                    "ordering": false,
                    "info": false,
                    "autoWidth": false,
                    "responsive": false,
                    "select": true,
                    "ajax": {
                        "url": "/Home/GetListNhatKyByDate",
                        "type": "GET",
                        "datatype": "json",
                        "data": { ngayStart: ngaystart, ngayEnd: ngayend },
                    },
                    "columns": [
                        { "data": "id", visible: false },
                        {
                            "data": null, render: function (data, type, row) {
                                var details = "<class='text-center' style='color:darkturquoise;'>" + row.userId + "<class='text-center' style='color:WindowText;'>" + " vừa " + row.thaotac + "<br>"
                                var sotien = "<class='text-center' style='font-weight:bolder;font-size:large;'>" + CurrencyFormatted(row.sotien) + "<class='text-center' style='font-weight:normal;'>" + "<br>"
                                var ngaygio = row.phut >= 60 ? row.gio >= 24 ? row.ngay + " ngày trước" : row.gio + " giờ trước" : row.phut + " phút trước"
                                return details + sotien + ngaygio;
                            }
                        },
                    ],
                    "drawCallback": function (settings) {
                        $("#TableNhatKy thead").remove();
                    },
                    "language": {

                        "emptyTable": "Chưa có nội dung hiện thị"
                    }

                });
                setTimeout(CacHoatDong, 20000);
                $('.overlay').hide();
            });
            //ban dang co khach
            var dt = $('#TableCoKhach').DataTable({
                "paging": false,
                "lengthChange": true,
                "searching": false,
                "ordering": false,
                "info": false,
                "autoWidth": false,
                "responsive": false,
                "ajax": {
                    "url": "/Home/GetListBanCoKhach",
                    "type": "GET",
                    "datatype": "json",
                },
                "columns": [
                    {
                        "class": "details-control",
                        "orderable": false,
                        "data": null,
                        "defaultContent": "", className: "text-center", width: "5%",
                    },
                    { "data": "TenBan", className: "text-center", width: "45%", },
                    {
                        "data": null, render: function (data, type, row) {
                            var details = moment(row.GioVao).format('HH:mm A');
                            return details;
                        }, className: "text-center", width: "30%",
                    },
                    { "data": "TongTien", render: $.fn.dataTable.render.number(',', '.', 0), className: "text-right", width: "20%" },

                ],

            });
            function format(rowData) {
                var div = $('<div/>')
                $.ajax({
                    url: "/Home/GetListViewProductById",
                    method: "GET",
                    dataType: "json",
                    data: { id: rowData.Phieu_ID },
                    success: function (data) {
                        var items = '<table><tr><th>Tên hàng</th><th>ĐVT</th><th>Số lượng</th><th>Đơn giá</th><th>Thành tiền</th></tr>';
                        $.each(data, function (i, d) {
                            items += "<tr><td>" + d.TenHH + "</td><td>" + d.TenDVT + "</td><td align='right'>" + CurrencyFormatted(d.SoLuong) + "</td><td align='right'>" + CurrencyFormatted(d.DonGiaBan) + "</td><td align='right'>" + CurrencyFormatted(d.ThanhTienBan) + "</td></tr>";

                        });
                        items += "</table>";
                        div.html(items);
                    }

                });

                return div;

            }

            // Array to track the ids of the details displayed rows
            var detailRows = [];
            $('#TableCoKhach tbody').on('click', 'td.details-control', function () {
                var tr = $(this).closest('tr');
                var row = dt.row(tr);
                var idx = $.inArray(tr.attr('id'), detailRows);

                if (row.child.isShown()) {
                    tr.removeClass('details');
                    row.child.hide();

                    // Remove from the 'open' array
                    detailRows.splice(idx, 1);
                }
                else {
                    tr.addClass('details');
                    row.child(format(row.data())).show();

                    //// Add to the 'open' array
                    if (idx === -1) {
                        detailRows.push(tr.attr('id'));
                    }
                }
            });
            // On each draw, loop over the `detailRows` array and show any child rows
            dt.on('draw', function () {
                $.each(detailRows, function (i, id) {
                    $('#' + id + ' td.details-control').trigger('click');
                });
            });

            //top 10 hang ban theo doanh so
            $(function DoanhSoTop10() {
                $.ajax({
                    url: "/Home/GetBestSellerDoanhSo",
                    type: "GET",
                    dataType: "JSON",
                    success: function (data) {
                        //Ten
                        var Ten01 = data.TenHH[0];
                        var Ten02 = data.TenHH[1];
                        var Ten03 = data.TenHH[2];
                        var Ten04 = data.TenHH[3];
                        var Ten05 = data.TenHH[4];
                        var Ten06 = data.TenHH[5];
                        var Ten07 = data.TenHH[6];
                        var Ten08 = data.TenHH[7];
                        var Ten09 = data.TenHH[8];
                        var Ten10 = data.TenHH[9];
                        //So luong
                        var TopSL01 = data.ThanhTien[0];
                        var TopSL02 = data.ThanhTien[1];
                        var TopSL03 = data.ThanhTien[2];
                        var TopSL04 = data.ThanhTien[3];
                        var TopSL05 = data.ThanhTien[4];
                        var TopSL06 = data.ThanhTien[5];
                        var TopSL07 = data.ThanhTien[6];
                        var TopSL08 = data.ThanhTien[7];
                        var TopSL09 = data.ThanhTien[8];
                        var TopSL10 = data.ThanhTien[9];
                        if (TopSL01 == "" || TopSL01 == null) {
                            TopSL01 = 0;
                        }
                        if (TopSL02 == "" || TopSL02 == null) {
                            TopSL02 = 0;
                        }
                        if (TopSL03 == "" || TopSL03 == null) {
                            TopSL03 = 0;
                        }
                        if (TopSL04 == "" || TopSL04 == null) {
                            TopSL04 = 0;
                        }
                        if (TopSL05 == "" || TopSL05 == null) {
                            TopSL05 = 0;
                        }
                        if (TopSL06 == "" || TopSL06 == null) {
                            TopSL06 = 0;
                        }
                        if (TopSL07 == "" || TopSL07 == null) {
                            TopSL07 = 0;
                        }
                        if (TopSL08 == "" || TopSL08 == null) {
                            TopSL08 = 0;
                        }
                        if (TopSL09 == "" || TopSL09 == null) {
                            TopSL09 = 0;
                        }
                        if (TopSL10 == "" || TopSL10 == null) {
                            TopSL10 = 0;
                        }
                        $.ajax({
                            type: "POST",
                            url: '@Url.Action("Top10SoLuongChart", "Home")',
                            data: JSON.stringify({

                                TopSL01: TopSL01,
                                TopSL02: TopSL02,
                                TopSL03: TopSL03,
                                TopSL04: TopSL04,
                                TopSL05: TopSL05,
                                TopSL06: TopSL06,
                                TopSL07: TopSL07,
                                TopSL08: TopSL08,
                                TopSL09: TopSL09,
                                TopSL10: TopSL10,
                            }),
                            contentType: "application/json",
                            dataType: "json",
                            success: function (chData) {
                                var aData = chData;
                                var aLabels = aData[0];
                                var aDatasets1 = aData[1];

                                //For Bar Chart
                                var ctx = document.getElementById("Top10DoanhThu").getContext('2d');
                                ctx.height = 230;
                                var Top10DoanhThu = new Chart(ctx, {
                                    type: 'horizontalBar',
                                    height: "230px",
                                    width: "150px",
                                    autoSkip: true,
                                    responsive: false,
                                    animation: false,
                                    showDatapoints: true,
                                    legend: { position: 'bottom' },
                                    data: {
                                        //labels: ["M", "T", "W", "T", "F", "S", "S"],
                                        labels: [Ten01, Ten02, Ten03, Ten04, Ten05, Ten06, Ten07, Ten08, Ten09, Ten10],
                                        datasets: [{
                                            label: 'Chỉ tiêu doanh số',
                                            data: [TopSL01, TopSL02, TopSL03, TopSL04, TopSL05, TopSL06, TopSL07, TopSL08, TopSL09, TopSL10],
                                            //backgroundColor: ["red", "blue", "green", "yellow", "pink", "brown", "orange", "gray", "purple", "black"]
                                            backgroundColor: '#007bff',
                                            borderColor: '#007bff',

                                        }]
                                    },
                                    options: {
                                        tooltips: {
                                            callbacks: {
                                                label: function (t, d) {
                                                    var yLabel = d.datasets[t.datasetIndex].label;
                                                    var xLabel = t.xLabel >= 1000 ? t.xLabel.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") : + t.xLabel;
                                                    return yLabel + ': ' + xLabel;
                                                }
                                            }

                                        },
                                        events: ['click'],
                                        scaleShowValues: true,
                                        scales: {
                                            yAxes: [{
                                                gridLines: {
                                                    display: true,
                                                    lineWidth: '4px',
                                                    color: 'rgba(0, 0, 0, .2)',
                                                    zeroLineColor: 'transparent'
                                                },
                                                ticks: {
                                                    autoSkip: false

                                                }

                                            }],
                                            xAxes: [{
                                                ticks: {

                                                     beginAtZero: true,
                                                     callback: function (value, index, values) {
                                                         if (parseInt(value) <= 1000) {
                                                             value /= 1000
                                                             return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "k";
                                                         } else {
                                                             value /= 1000000
                                                             return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "tr";;
                                                         }
                                                    }
                                                }
                                            }]
                                        }
                                    }
                                });

                            },
                            "error": function (data) {
                                alert("Chưa có đủ số liệu!");
                            }
                        });

                    },
                    "error": function (data) {
                        alert("Some Error Occured in controller!");
                    }

                });
            });
            //top 10 hang ban theo so luong
            $(function SoLuongTop10() {
                $.ajax({
                    url: "/Home/GetBestSellerSoLuong",
                    type: "GET",
                    dataType: "JSON",
                    success: function (data) {
                        //Ten
                        var Ten01 = data.TenHH[0];
                        var Ten02 = data.TenHH[1];
                        var Ten03 = data.TenHH[2];
                        var Ten04 = data.TenHH[3];
                        var Ten05 = data.TenHH[4];
                        var Ten06 = data.TenHH[5];
                        var Ten07 = data.TenHH[6];
                        var Ten08 = data.TenHH[7];
                        var Ten09 = data.TenHH[8];
                        var Ten10 = data.TenHH[9];
                        //So luong
                        var TopSL01 = data.SoLuong[0];
                        var TopSL02 = data.SoLuong[1];
                        var TopSL03 = data.SoLuong[2];
                        var TopSL04 = data.SoLuong[3];
                        var TopSL05 = data.SoLuong[4];
                        var TopSL06 = data.SoLuong[5];
                        var TopSL07 = data.SoLuong[6];
                        var TopSL08 = data.SoLuong[7];
                        var TopSL09 = data.SoLuong[8];
                        var TopSL10 = data.SoLuong[9];
                        if (TopSL01 == "" || TopSL01 == null) {
                            TopSL01 = 0;
                        }
                        if (TopSL02 == "" || TopSL02 == null) {
                            TopSL02 = 0;
                        }
                        if (TopSL03 == "" || TopSL03 == null) {
                            TopSL03 = 0;
                        }
                        if (TopSL04 == "" || TopSL04 == null) {
                            TopSL04 = 0;
                        }
                        if (TopSL05 == "" || TopSL05 == null) {
                            TopSL05 = 0;
                        }
                        if (TopSL06 == "" || TopSL06 == null) {
                            TopSL06 = 0;
                        }
                        if (TopSL07 == "" || TopSL07 == null) {
                            TopSL07 = 0;
                        }
                        if (TopSL08 == "" || TopSL08 == null) {
                            TopSL08 = 0;
                        }
                        if (TopSL09 == "" || TopSL09 == null) {
                            TopSL09 = 0;
                        }
                        if (TopSL10 == "" || TopSL10 == null) {
                            TopSL10 = 0;
                        }

                        $.ajax({
                            type: "POST",
                            url: '@Url.Action("Top10SoLuongChart", "Home")',
                            data: JSON.stringify({

                                TopSL01: TopSL01,
                                TopSL02: TopSL02,
                                TopSL03: TopSL03,
                                TopSL04: TopSL04,
                                TopSL05: TopSL05,
                                TopSL06: TopSL06,
                                TopSL07: TopSL07,
                                TopSL08: TopSL08,
                                TopSL09: TopSL09,
                                TopSL10: TopSL10,
                            }),
                            contentType: "application/json",
                            dataType: "json",
                            success: function (chData) {
                                var aData = chData;
                                var aLabels = aData[0];
                                var aDatasets1 = aData[1];

                                //For Bar Chart
                                var ctx = document.getElementById("Top10SoLuong").getContext('2d');
                                ctx.height = 230;
                                var Top10SoLuong = new Chart(ctx, {
                                    type: 'horizontalBar',
                                    height: "230px",
                                    width: "150px",
                                    autoSkip: true,
                                    responsive: false,
                                    animation: false,
                                    showDatapoints: true,
                                    legend: { position: 'bottom' },
                                    data: {
                                        //labels: ["M", "T", "W", "T", "F", "S", "S"],
                                        labels: [Ten01, Ten02, Ten03, Ten04, Ten05, Ten06, Ten07, Ten08, Ten09, Ten10],
                                        datasets: [{
                                            label: 'Chỉ tiêu số lượng',
                                            data: [TopSL01, TopSL02, TopSL03, TopSL04, TopSL05, TopSL06, TopSL07, TopSL08, TopSL09, TopSL10],
                                            //backgroundColor: ["red", "blue", "green", "yellow", "pink", "brown", "orange", "gray", "purple", "black"]
                                            backgroundColor: '#0bead8',
                                            borderColor: '#0bead8',

                                        }]
                                    },
                                    options: {
                                        tooltips: {
                                            callbacks: {
                                                label: function (t, d) {
                                                    var yLabel = d.datasets[t.datasetIndex].label;
                                                    var xLabel = t.xLabel >= 1000 ? t.xLabel.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") : + t.xLabel;
                                                    return yLabel + ': ' + xLabel;
                                                }
                                            }

                                        },
                                        events: ['click'],
                                        scaleShowValues: true,
                                        scales: {
                                            yAxes: [{
                                                gridLines: {
                                                    display: true,
                                                    lineWidth: '4px',
                                                    color: 'rgba(0, 0, 0, .2)',
                                                    zeroLineColor: 'transparent'
                                                },
                                                ticks: {
                                                    autoSkip: false

                                                }

                                            }],
                                            xAxes: [{
                                                ticks: {

                                                     beginAtZero: true,
                                                     callback: function (value, index, values) {
                                                         if (parseInt(value) >= 1000) {
                                                             value /= 1000
                                                             return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "k";
                                                         } else {

                                                             return value;
                                                         }


                                                    }
                                                }
                                            }]
                                        }
                                    }
                                });

                            },
                            "error": function (data) {
                                alert("Chưa đủ số liệu!");
                            }
                        });

                    },
                    "error": function (data) {
                        alert("Chưa đủ số liệu trong controller!");
                    }

                });
            });
          
            //format number for display
            function CurrencyFormatted(nStr) {
                nStr += '';
                x = nStr.split(',');
                x1 = x[0];
                x2 = x.length > 1 ? ',' + x[1] : '';
                var rgx = /(\d+)(\d{3})/;
                while (rgx.test(x1)) {
                    x1 = x1.replace(rgx, '$1' + ',' + '$2');
                }
                return x1 + x2;
            }
        });
    </script>
}